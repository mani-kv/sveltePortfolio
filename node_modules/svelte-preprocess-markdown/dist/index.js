"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("marked")),r=e(require("front-matter"));const n=e=>{const r=t.getDefaults();return r.renderer=c(),e=Object.assign(r,{headerIds:!1},e),t.setOptions(e),function(e){const t=e.defaults.renderer.paragraph.bind({});e.defaults.renderer.paragraph=e=>e.match(/^([\s]*%svelte\-md\-block\-\w+\-\d+%)+[\s]*$/)?e.replace(/<br>/g,"\n")+"\n":t(e)}(t),function(e,t){e.defaults.renderer.checkbox=e=>"<input "+(e?'checked="checked" ':"")+'disabled="disabled" type="checkbox"'+(t.xhtml?" /":"")+"> "}(t,e),t};const c=()=>new t.Renderer;let l=[];const s=e=>l.push(e),o=()=>l,a=()=>l=[];function i(){let e=[],t=0;const r=r=>(e[t++]=r,"");return{before:(e,t)=>{e=(e=>{if(!e.match(/^[\t ]*<script[\S\s]*?>[\S\s]*?<\/script>/gim)){const t=/^[\s]*(import .+ from .+)[\s]*$/gim,r=[];let n;for(;n=t.exec(e);)r.push(n[1]);r.length>0&&(e=e.replace(t,""),r.forEach(e=>{s(e)}))}return e})(e);return e=e.replace(/^[\s]*<(?:script|style)[^>]*>[\S\s]*?<\/.+>[\s]*$/gim,r)},after:(t,r)=>e.length>0?t+"\n\n"+e.join("\n\n"):t}}function p(){let e=[],t=0;const r=r=>(e[t++]=r,`%svelte-md-inline-i11n-${t}%`),n=(t,r)=>e[r-1];return{before:(e,t)=>{const n=/{[^#@:\/][^{}]+}/gm;for(;e.match(n);)e=e.replace(n,r);return e},after:(e,t)=>{const r=/\%svelte\-md\-inline\-i11n\-(\d+)\%/g;for(;e.match(r);)e=e.replace(r,n);return e}}}function d(){let e=[],t=0,r=()=>{};const n=(r,n,c)=>(e[t++]=c,n+"%svelte-md-block-tag-"+t+"%"),c=(n,c,l,o,a,i,p)=>(a.length>0&&(a=(a=s(a,r)).replace(new RegExp(`^[\\t ]{0,${i.length}}`,"gm"),""),(a=r(a)).trim().match(/[\r\n]/g)||(a=a.replace(/<p>|<\/p>/g,"").trim())),e[t++]=`${l}${a}${p}`,c+"%svelte-md-block-tag-"+t+"%"),l=(t,r)=>e[r-1],s=(e,t)=>{r=t;e=e.replace(/([\t ]*)(<\w+[^>]*\/>)/g,n);const l=/([\t ]*)(<([\w-:]+)[^>]*>)\n?(([\s]*)[^<]*?)(<\/\3>)/gm;for(;e.match(l);)e=e.replace(l,c);return e=e.replace(/^[\\t ]+(%svelte\-md\-block\-tag\-\d+%)/gm,"$1")};return{before:s,after:(e,t)=>{const r=/%svelte\-md\-block\-tag\-(\d+)%/g;for(;e.match(r);)e=e.replace(r,l);return e}}}function g(){let e=[],t=0,r=()=>{};const n=(n,c,l,s,a,i,p)=>{if(a.length>0){const e=(a=(a=o(a,r)).replace(new RegExp(`^[\\t ]{0,${i.length}}`,"gm"),"")).split(/\{:.+\}/);for(let t=0;t<e.length;t++){let n=e[t];const c=/[\r\n]/.test(n);n=r(n),n=c?"\n"+n:n.replace(/<p>|<\/p>/g,"").trim(),a=a.replace(e[t],n)}}return e[t++]=`${l}${a}${p}`,c+"%svelte-md-block-logic-"+t+"%"},c=(t,r)=>e[r-1],l=(e,t,r,n,c,l)=>`<${r}${n}>\n${t}\n${c}${l}\n</${r}>`,s=(e,t,r)=>{const n=function(e){let t,r=[],n=/<th(?: align="(.+?)")*>.+?<\/th>/gim;for(;t=n.exec(e);)r.push(t[1]||"left");return r}(t);return`<table>\n<thead><tr>${t}</tr></thead>\n<tbody>\n${r=(r=r.replace(/{:else}\s+?<p>(.+)<\/p>\s+?{\/each}/gim,(e,t)=>{return`{:else}\n${r=t,c=n,`<tr><td${c.length>1?` colspan="${c.length}"`:""}>${r}</td></tr>`}\n{/each}`;var r,c})).replace(/^(?:<p>)?(\|.+\|)(?:<\/p>)?$/gim,(e,t)=>{return r=n,t.split("\n").map(e=>{let t=e.split("|");return t.length-r.length!=2||""!==t[0]||""!==t[t.length-1]?e:(t=t.slice(1,-1).map((e,t)=>`<td${"left"===r[t]?"":` align="${r[t]}"`}>${e}</td>`),`<tr>${t.join("")}</tr>`)}).join("\n");var r})}\n</tbody>\n</table>`},o=(e,t)=>{r=t;const c=/([ \t]*)(\{#([a-z]+)[^}]*})(\n?([\s]*)[\S\s]*?)(\{\/\3\})/gim;for(;e.match(c);)e=e.replace(c,n);return e=e.replace(/^[\\t ]+(%svelte\-md\-block\-logic\-\d+%)/gm,"$1")};return{before:o,after:(e,t)=>{const r=/%svelte\-md\-block\-logic\-(\d+)%/g;for(;e.match(r);)e=e.replace(r,c);return e=(e=e.replace(/({#each.*?})\s*<([uo]l)(.*?)>\s*([\s\S]*)<\/\2>\s*({\/each})/gim,l)).replace(/<table>\s*<thead>\s*<tr>((?:(?!<\/tr>)[\s\S])+)<\/tr>\s*<\/thead>\s*<tbody>\s*<tr>\s*<td(?: align=".+")*>((?:(?!<\/table>)[\s\S])*(?:<p>\|[\s\S]+?\|<\/p>)[\s\S]*?)<\/td>[\s\S]+?<\/tr>\s*<\/tbody>\s*<\/table>/gim,s)}}}function f(){let e=[],t=0,r=()=>{};const n=(e,t=!1)=>(e=e.replace(/{/g,"&#123;").replace(/}/g,"&#125;"),t&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")),e),c=(r,c)=>(e[t++]=n(c,!0),"```%svelte-md-inline-code-"+t+"%```"),l=(c,l)=>(c=c.replace(new RegExp(`^[\\t ]{0,${l}}`,"gm"),""),c=n(r(c)),e[t++]=c,"%svelte-md-block-code-"+t+"%"),o=(t,r)=>e[r-1],a=(t,r)=>(s("const CODEBLOCK_"+r+" = `"+e[r-1].replace(/`/g,"\\`")+"`;"),`{@html CODEBLOCK_${r}}`);return{before:(e,t)=>{r=t;e=e.replace(/```(.+?)```/g,c);const n=/^([\t ]*)(```.*)[\t ]*$/gm;let s,o=0,a=[];const i={start:0,end:0,spaces:0};for(;s=n.exec(e);)s[2].length>3?(o++,1===o&&(i.start=s.index,i.spaces=s[1].length)):3===s[2].length&&(o--,0===o&&(i.end=s.index+s[1].length+3,a.push({...i}),i.start=i.spaces=i.end=0));let p=e;for(let t=0;t<a.length;t++){const r=e.slice(a[t].start,a[t].end);p=p.replace(r,()=>l(r,a[t].spaces))}return p},after:(e,t)=>e=(e=e.replace(/%svelte\-md\-inline\-code\-(\d+)%/g,o)).replace(/%svelte\-md\-block\-code\-(\d+)%/g,a)}}exports.Renderer=function(){return c()},exports.markdown=function(e={}){const t=n(e);return e.filetype=e.filetype||"md",{markup({content:n,filename:c}){const l=[{before:(e,t)=>{const{attributes:n,body:c}=r(e);return s(`export const META = ${JSON.stringify(n)};`),c},after:(e,t)=>e},f(),i(),p(),g(),d()];if(c.endsWith("."+e.filetype)){for(let e=0;e<l.length;e++)n=l[e].before(n,t);n=t(n);for(let e=l.length-1;e>=0;e--)n=l[e].after(n,t);n=function(e){const t=o();if(t.length>0){const r=/^[\t ]*(<script[\t ]+?context="module"[\t ]*?>)[\S\s]*?<\/script>/gim.exec(e);e=r?e.replace(r[1],`${r[1]}\n${t.join(";\n")}\n`):`${e}\n\n<script context="module">\n${t.join("\n")}\n<\/script>`,a()}return e}(n)}return{code:n}}}};
