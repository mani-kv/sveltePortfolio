import e from"marked";import t from"front-matter";const n=t=>{const n=e.getDefaults();return n.renderer=r(),t=Object.assign(n,{headerIds:!1},t),e.setOptions(t),function(e){const t=e.defaults.renderer.paragraph.bind({});e.defaults.renderer.paragraph=e=>e.match(/^([\s]*%svelte\-md\-block\-\w+\-\d+%)+[\s]*$/)?e.replace(/<br>/g,"\n")+"\n":t(e)}(e),function(e,t){e.defaults.renderer.checkbox=e=>"<input "+(e?'checked="checked" ':"")+'disabled="disabled" type="checkbox"'+(t.xhtml?" /":"")+"> "}(e,t),e};const r=()=>new e.Renderer;let c=[];const l=e=>c.push(e),s=()=>c,o=()=>c=[];function a(){let e=[],t=0;const n=n=>(e[t++]=n,"");return{before:(e,t)=>{e=(e=>{if(!e.match(/^[\t ]*<script[\S\s]*?>[\S\s]*?<\/script>/gim)){const t=/^[\s]*(import .+ from .+)[\s]*$/gim,n=[];let r;for(;r=t.exec(e);)n.push(r[1]);n.length>0&&(e=e.replace(t,""),n.forEach(e=>{l(e)}))}return e})(e);return e=e.replace(/^[\s]*<(?:script|style)[^>]*>[\S\s]*?<\/.+>[\s]*$/gim,n)},after:(t,n)=>e.length>0?t+"\n\n"+e.join("\n\n"):t}}function p(){let e=[],t=0;const n=n=>(e[t++]=n,`%svelte-md-inline-i11n-${t}%`),r=(t,n)=>e[n-1];return{before:(e,t)=>{const r=/{[^#@:\/][^{}]+}/gm;for(;e.match(r);)e=e.replace(r,n);return e},after:(e,t)=>{const n=/\%svelte\-md\-inline\-i11n\-(\d+)\%/g;for(;e.match(n);)e=e.replace(n,r);return e}}}function i(){let e=[],t=0,n=()=>{};const r=(n,r,c)=>(e[t++]=c,r+"%svelte-md-block-tag-"+t+"%"),c=(r,c,l,o,a,p,i)=>(a.length>0&&(a=(a=s(a,n)).replace(new RegExp(`^[\\t ]{0,${p.length}}`,"gm"),""),(a=n(a)).trim().match(/[\r\n]/g)||(a=a.replace(/<p>|<\/p>/g,"").trim())),e[t++]=`${l}${a}${i}`,c+"%svelte-md-block-tag-"+t+"%"),l=(t,n)=>e[n-1],s=(e,t)=>{n=t;e=e.replace(/([\t ]*)(<\w+[^>]*\/>)/g,r);const l=/([\t ]*)(<([\w-:]+)[^>]*>)\n?(([\s]*)[^<]*?)(<\/\3>)/gm;for(;e.match(l);)e=e.replace(l,c);return e=e.replace(/^[\\t ]+(%svelte\-md\-block\-tag\-\d+%)/gm,"$1")};return{before:s,after:(e,t)=>{const n=/%svelte\-md\-block\-tag\-(\d+)%/g;for(;e.match(n);)e=e.replace(n,l);return e}}}function g(){let e=[],t=0,n=()=>{};const r=(r,c,l,s,a,p,i)=>{if(a.length>0){const e=(a=(a=o(a,n)).replace(new RegExp(`^[\\t ]{0,${p.length}}`,"gm"),"")).split(/\{:.+\}/);for(let t=0;t<e.length;t++){let r=e[t];const c=/[\r\n]/.test(r);r=n(r),r=c?"\n"+r:r.replace(/<p>|<\/p>/g,"").trim(),a=a.replace(e[t],r)}}return e[t++]=`${l}${a}${i}`,c+"%svelte-md-block-logic-"+t+"%"},c=(t,n)=>e[n-1],l=(e,t,n,r,c,l)=>`<${n}${r}>\n${t}\n${c}${l}\n</${n}>`,s=(e,t,n)=>{const r=function(e){let t,n=[],r=/<th(?: align="(.+?)")*>.+?<\/th>/gim;for(;t=r.exec(e);)n.push(t[1]||"left");return n}(t);return`<table>\n<thead><tr>${t}</tr></thead>\n<tbody>\n${n=(n=n.replace(/{:else}\s+?<p>(.+)<\/p>\s+?{\/each}/gim,(e,t)=>{return`{:else}\n${n=t,c=r,`<tr><td${c.length>1?` colspan="${c.length}"`:""}>${n}</td></tr>`}\n{/each}`;var n,c})).replace(/^(?:<p>)?(\|.+\|)(?:<\/p>)?$/gim,(e,t)=>{return n=r,t.split("\n").map(e=>{let t=e.split("|");return t.length-n.length!=2||""!==t[0]||""!==t[t.length-1]?e:(t=t.slice(1,-1).map((e,t)=>`<td${"left"===n[t]?"":` align="${n[t]}"`}>${e}</td>`),`<tr>${t.join("")}</tr>`)}).join("\n");var n})}\n</tbody>\n</table>`},o=(e,t)=>{n=t;const c=/([ \t]*)(\{#([a-z]+)[^}]*})(\n?([\s]*)[\S\s]*?)(\{\/\3\})/gim;for(;e.match(c);)e=e.replace(c,r);return e=e.replace(/^[\\t ]+(%svelte\-md\-block\-logic\-\d+%)/gm,"$1")};return{before:o,after:(e,t)=>{const n=/%svelte\-md\-block\-logic\-(\d+)%/g;for(;e.match(n);)e=e.replace(n,c);return e=(e=e.replace(/({#each.*?})\s*<([uo]l)(.*?)>\s*([\s\S]*)<\/\2>\s*({\/each})/gim,l)).replace(/<table>\s*<thead>\s*<tr>((?:(?!<\/tr>)[\s\S])+)<\/tr>\s*<\/thead>\s*<tbody>\s*<tr>\s*<td(?: align=".+")*>((?:(?!<\/table>)[\s\S])*(?:<p>\|[\s\S]+?\|<\/p>)[\s\S]*?)<\/td>[\s\S]+?<\/tr>\s*<\/tbody>\s*<\/table>/gim,s)}}}function d(){let e=[],t=0,n=()=>{};const r=(e,t=!1)=>(e=e.replace(/{/g,"&#123;").replace(/}/g,"&#125;"),t&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")),e),c=(n,c)=>(e[t++]=r(c,!0),"```%svelte-md-inline-code-"+t+"%```"),s=(c,l)=>(c=c.replace(new RegExp(`^[\\t ]{0,${l}}`,"gm"),""),c=r(n(c)),e[t++]=c,"%svelte-md-block-code-"+t+"%"),o=(t,n)=>e[n-1],a=(t,n)=>(l("const CODEBLOCK_"+n+" = `"+e[n-1].replace(/`/g,"\\`")+"`;"),`{@html CODEBLOCK_${n}}`);return{before:(e,t)=>{n=t;e=e.replace(/```(.+?)```/g,c);const r=/^([\t ]*)(```.*)[\t ]*$/gm;let l,o=0,a=[];const p={start:0,end:0,spaces:0};for(;l=r.exec(e);)l[2].length>3?(o++,1===o&&(p.start=l.index,p.spaces=l[1].length)):3===l[2].length&&(o--,0===o&&(p.end=l.index+l[1].length+3,a.push({...p}),p.start=p.spaces=p.end=0));let i=e;for(let t=0;t<a.length;t++){const n=e.slice(a[t].start,a[t].end);i=i.replace(n,()=>s(n,a[t].spaces))}return i},after:(e,t)=>e=(e=e.replace(/%svelte\-md\-inline\-code\-(\d+)%/g,o)).replace(/%svelte\-md\-block\-code\-(\d+)%/g,a)}}function m(e={}){const r=n(e);return e.filetype=e.filetype||"md",{markup({content:n,filename:c}){const m=[{before:(e,n)=>{const{attributes:r,body:c}=t(e);return l(`export const META = ${JSON.stringify(r)};`),c},after:(e,t)=>e},d(),a(),p(),g(),i()];if(c.endsWith("."+e.filetype)){for(let e=0;e<m.length;e++)n=m[e].before(n,r);n=r(n);for(let e=m.length-1;e>=0;e--)n=m[e].after(n,r);n=function(e){const t=s();if(t.length>0){const n=/^[\t ]*(<script[\t ]+?context="module"[\t ]*?>)[\S\s]*?<\/script>/gim.exec(e);e=n?e.replace(n[1],`${n[1]}\n${t.join(";\n")}\n`):`${e}\n\n<script context="module">\n${t.join("\n")}\n<\/script>`,o()}return e}(n)}return{code:n}}}}function f(){return r()}export{f as Renderer,m as markdown};
